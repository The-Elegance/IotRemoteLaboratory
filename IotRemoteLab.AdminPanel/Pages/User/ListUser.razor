@page "/ListUser"

@using System.ComponentModel.DataAnnotations
@using System.Text.Json;
@using IotRemoteLab.Common.Components.Form
@using IotRemoteLab.Domain
@using IotRemoteLab.Domain.Role


@inject ModalService _modalService
@inject ConfirmService ComfirmService;
@inject HttpClient _httpClient

<h3>List Users</h3>

<Table @ref="_userTable" TItem="User" PageSize="5" Total="_total" DataSource="_users" @bind-SelectedRows="_selectedRows">
    <PropertyColumn Property="c=>c.Name">
        <a>@context.Name</a>
    </PropertyColumn>
    <PropertyColumn Property="c=>c.Surname">
        <a>@context.Surname</a>
    </PropertyColumn>
    <PropertyColumn Property="c=>c.Email">
        <a>@context.Email</a>
    </PropertyColumn>

</Table>

@code {
    ITable _userTable;
    List<User> _users = new List<User>
    {
       new User { Id = Guid.NewGuid(), Email ="0", PasswordHash = "0", Name = "Name1", Surname = "0", Roles = new List<Role> { } },
       new User { Id = Guid.NewGuid(), Email ="1", PasswordHash = "1", Name = "Name222", Surname = "1", Roles = new List<Role> { } },
       new User { Id = Guid.NewGuid(), Email ="2", PasswordHash = "2", Name = "Name33", Surname = "2", Roles = new List<Role> { } }
    };

    // protected override Task OnInitializedAsync() => UpdateList();

    // async Task UpdateList()
    // {
    //     _users = await _httpClient.GetFromJsonAsync<List<User?>>("api/v1/stands");
    // }

    List<User> mockDb = new();
    IEnumerable<User> _selectedRows = [];
    int _total;
    protected override void OnInitialized()
    {
        mockDb = Enumerable.Range(0, _users.Count).Select(i => _users[i]).ToList();
    }
}